@using MudBlazor

<MudDialog>
    <TitleContent>
        <MudText Typo="Typo.h6">
            <MudIcon Icon="@Icons.Material.Filled.Warning" Color="Color.Warning" Class="mr-2" />
            Delete Configuration
        </MudText>
    </TitleContent>
    <DialogContent>
        <MudStack Spacing="3">
            <MudText>
                Are you sure you want to delete <strong>@ConfigAlias</strong>?
            </MudText>

            @if (IsOnlyConfig)
            {
                <MudAlert Severity="Severity.Warning" Dense="true">
                    This is your only configuration. You will need to add a new one to use the extension.
                </MudAlert>
            }

            @if (PasskeyCount > 0)
            {
                <MudCheckBox @bind-Value="_deletePasskeys" Color="Color.Error">
                    Also delete @PasskeyCountLabel for this configuration
                </MudCheckBox>
                <MudText Typo="Typo.caption" Color="Color.Secondary">
                    If unchecked, passkeys will be preserved but won't work until you recreate this configuration.
                </MudText>
            }
        </MudStack>
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="Cancel" Variant="Variant.Text">Cancel</MudButton>
        <MudButton OnClick="Confirm" Variant="Variant.Filled" Color="Color.Error">Delete</MudButton>
    </DialogActions>
</MudDialog>

@code {
    [CascadingParameter]
    private IMudDialogInstance? MudDialog { get; set; }

    [Parameter]
    public string ConfigAlias { get; set; } = "";

    [Parameter]
    public bool IsOnlyConfig { get; set; }

    [Parameter]
    public int PasskeyCount { get; set; }

    private bool _deletePasskeys;

    string PasskeyCountLabel => PasskeyCount == 1 ? "1 passkey" : $"{PasskeyCount} passkeys";

    private void Cancel() => MudDialog?.Cancel();

    private void Confirm() => MudDialog?.Close(DialogResult.Ok(_deletePasskeys));
}
