@page "/OfferPasskey.html"
@layout Layouts.MainLayout
@using Extension.Services.Storage
@using static Extension.AppConfig

@inject NavigationManager navManager
@inject ILogger<OfferPasskeyPage> logger
@inject IJSRuntime js

@code {
    protected override void OnInitialized()
    {
        logger.LogInformation("OfferPasskeyPage OnInitialized");
    }

    void AcceptOffer()
    {
        logger.LogInformation("User accepted passkey offer");
        App.OfferCreatePasskeyState = OfferCreatePasskeyState.Yes;
        navManager.NavigateTo(RouteToIndex);
    }

    void DeclineOffer()
    {
        logger.LogInformation("User declined passkey offer");
        App.OfferCreatePasskeyState = OfferCreatePasskeyState.No;
        navManager.NavigateTo(RouteToIndex);
    }
}

<div id="@this.GetType().Name" class="bt-body-page">
    <MudStack Class="bt-main">
        <div class="bt-main-inside-scroll">
            <MudText Typo="Typo.h6">Do you want to create a passkey?</MudText>
            <MudStack Class="mt-4">
                <MudText>
                    A passkey lets you unlock KERI Auth without typing your passcode every time.
                </MudText>
                <MudText Class="mt-2">
                    You'll need an authenticator that supports the CTAP 2.1 standard with PRF extension, such as a YubiKey 5 series, Google Titan key, or Google Password Manager (Chrome platform passkey).
                </MudText>
                <MudAlert Severity="Severity.Info" Dense="true" Class="mt-4">
                    <b>Note:</b> Windows Hello and Apple Touch ID/Face ID do not currently support the PRF extension required by KERI Auth.
                </MudAlert>
                <MudText Class="mt-4">
                    You can always create or manage passkeys later from the Passkeys page in the menu.
                </MudText>
            </MudStack>
        </div>
    </MudStack>
    <MudStack Row="true" class="bt-button-tray">
        <MudSpacer />
        <MudButton Variant="Variant.Text" OnClick="DeclineOffer">Maybe later</MudButton>
        <MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="AcceptOffer">Create Passkey</MudButton>
    </MudStack>
</div>
